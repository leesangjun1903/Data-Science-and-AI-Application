# Counterfactual Visual Explanations

## 1. 핵심 주장 및 주요 기여  
**핵심 주장:**  
딥 비전 모델이 특정 클래스 $$c$$ 대신 다른 클래스 $$c'$$를 예측하도록 이미지 속 어떤 부분을 어떻게 변경해야 하는지를 시각적으로 제시하는 **반사실적 설명** 기법을 제안한다.  

**주요 기여:**  
- **최소 편집 반사실 문제(Minimum-Edit Counterfactual):** 입력 이미지 $$I$$를 교란 이미지 $$I'$$의 일부 공간 특징으로 교체해 모델 예측을 $$c'$$로 바꾸는 최소 영역 교체 문제를 수식화.  
- **탐색 기반 솔루션:** ① 이산적 탐색(모든 위치쌍을 평가)과 ② 연속적 완화(softmax 기반 최적화)를 순차적 그리디 방식으로 제안.  
- **다양한 데이터셋 적용:** MNIST, Omniglot, Caltech-UCSD Birds(CUB) 등에서 질적·양적 실험을 통해 해석 가능성 및 차별성 검증.  
- **기계 교수 활용:** 반사실 시각 설명을 이용한 인간 학습 실험에서, 비전문가가 세밀한 분류 과제(조류 종 식별)를 더 효과적으로 학습함을 확인.  

***

## 2. 문제 정의 및 방법론  

### 2.1 최소 편집 반사실 문제  
입력 이미지 $$I$$에 대한 공간 특징 $$f(I)\in\mathbb{R}^{hw\times d}$$과 교란 이미지 $$I'$$의 특징 $$f(I')$$를 정의하고,  
변형 벡터 $$a\in\{0,1\}^{hw}$$와 퍼뮤테이션 행렬 $$P$$를 통해  

$$
f(I^*) = (1-a)\odot f(I) + a\odot P\,f(I')
$$  

를 구성한다.  
목표는 $$\|a\|_1$$ (교체 개수)을 최소화하며 모델 예측이 $$c'$$로 바뀌도록 하는 것이다.  

### 2.2 그리디 이산 탐색  
- **Best-Edit 서브문제:** $$\|a\|_1=1$$로 제한해 가능한 모든 $$(i,j)$$ 위치 교체를 평가해 $$\log P(c' \mid I^*)$$를 최대화하는 한 단계 최적 교체를 찾는다.  
- 이를 반복하며 예측이 $$c'$$로 바뀔 때까지 순차적 편집 수행.  

### 2.3 연속 완화 최적화  
- $$a$$와 $$P$$를 softmax 재매개변수화해 확률분포로 완화:  

$$
  a=\sigma(\alpha),\quad p_i=\sigma(m_i)
  $$  

- 엔트로피 규제를 추가해 해가 거의 이산적으로 수렴하도록 유도, 그리디 교체 절차에 적용.  

***

## 3. 모델 구조 및 실험 결과  

### 모델 구조  
- **MNIST/Omniglot:** 2개 합성곱 + 2개 완전연결 레이어  
- **CUB:** VGG-16 기반, 마지막 합성곱층(7×7×512) 특징 사용  

### 성능 및 효율  
- **평균 교체 횟수(MNIST):** 2.67회, **속도:** 15μs/이미지  
- **평균 교체 횟수(Omniglot):** 1.46회, **속도:** 9μs/이미지  
- **평균 교체 횟수(CUB):**  
  - 무작위 교란 클래스: 7.4회 (1.85s/이미지)  
  - 속성 유사 교란 클래스: 5.3회 (1.34s/이미지)  

### 한계  
- **연산 비용:** 고해상도·많은 클래스 환경에서 탐색 복잡도 증가  
- **포즈·정렬 민감도:** 서로 다른 자세의 이미지를 합성 시 시각적 불일치  
- **교란 선택 의존성:** 동일 클래스 내 교란 선택 시 해석 결과 약간 변동  

***

## 4. 일반화 성능 향상 가능성  
- **교차 도메인 적용:** 다양한 데이터셋(숫자→문자→자연 이미지)에서 안정적 해석  
- **모델 디버깅:** 잘못 분류된 사례에서 반사실적 교체를 통해 주요 오분류 원인 부위 식별 가능  
- **기계 교수 확장:** 인간 학습 최적화(few-shot, active learning) 등 다른 학습 시나리오로 확장 여지  
- **합성곱층 일반화:** 접근법은 임의 합성곱 레이어 특징에도 적용 가능해 더 깊은 네트워크로 확대  

***

## 5. 향후 연구에의 영향 및 고려 사항  
- **효율성 개선:** 탐색·최적화 알고리즘 경량화, 근사적·병렬화 전략 필요  
- **3D·비디오 설명:** 시계열 및 공간-시간 특징에 대한 반사실적 교체 연구  
- **공정성·안전성:** 반사실적 설명을 이용한 모델 편향·오류 진단 및 안전성 확보  
- **자동화된 교란 선택:** 대표적 교란 예시 자동 추천 메커니즘 개발  
- **인간-모델 협업:** 반사실적 설명을 활용한 인터랙티브 분석 플랫폼과 효과 검증  

이상으로, 본 논문은 **반사실적 설명**이라는 시각적 해석 패러다임을 제시하여 딥 비전 모델의 예측 근거를 보다 직관적이고 차별적으로 제공함으로써, 모델 이해·디버깅·기계 교수 분야에 폭넓은 영향을 미칠 것으로 기대된다.

[1](https://ppl-ai-file-upload.s3.amazonaws.com/web/direct-files/attachments/22370781/e3408822-5310-463f-afce-3039c7afc3d0/1904.07451v2.pdf)
