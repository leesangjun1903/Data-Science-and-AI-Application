# Fourier Neural Operator with Learned Deformations for PDEs on General Geometries

**핵심 아이디어**  
Geo-FNO는 딥러닝으로 편미분방정식(PDE)을 풀 때, 입력 도메인이 복잡한 형상을 가질 때도 FFT(Fast Fourier Transform)를 쓰게 해 주는 방법입니다.  
- **문제점**: 기존 FNO는 사각형 균일 그리드에서만 FFT를 쓸 수 있어, 비정형(불규칙) 형상에서는 정확도가 크게 떨어집니다.  
- **해결책**: ‘변형 네트워크’를 배워서 입력 도메인을 균일한 잠재(latent) 그리드로 끌어오고, 그 위에서 FFT 기반 연산을 수행한 뒤 결과를 다시 원래 도메인으로 되돌립니다.

## 1. 전체 구조

1. **입력 리프팅(P)**  
   – 물리 도메인(불규칙 형상)의 스칼라/벡터 필드를 채널 차원을 늘려서 임베딩  
2. **기하학적 변형 (ϕ⁻¹)**  
   – 입력 도메인의 각 점 x를 균일 잠재 그리드 ξ 로 매핑  
   – 학습 가능한 MLP(다층 퍼셉트론)를 사용  
3. **푸리에 레이어 (Kₗ)**  
   – 잠재 그리드 ξ에서 FFT → 주파수 도메인에서 선형 변환 → 역FFT  
4. **비선형 활성화(σ)**  
   – GeLU 등  
5. **출력 프로젝션(Q)**  
   – 채널 차원을 줄여 결과 필드를 복원  
6. **역변형 (ϕ)**  
   – 잠재 그리드의 결과를 원래 물리 도메인 점 x로 맵핑  

이 과정을 L개의 레이어로 쌓아 최종 연산자 $$G_\theta$$를 정의합니다.

## 2. 왜 일반화 성능이 좋은가?

1. **학습된 변형**  
   – 훈련 시 다양한 형상을 보여 주면, 네트워크가 “이런 모양을 이렇게 펼쳐야 FFT하기 좋다”를 자동으로 배웁니다.  
   – 그래서 새로운 형상에서도 비슷하게 매핑해 정확도를 유지할 가능성이 높습니다.

2. **격자 해상도 독립성(분산해상도 수렴성)**  
   – 56×51 해상도로 학습해도, 221×51 고해상도에서 그대로 평가 가능  
   – 학습된 파라미터를 여러 해상도에 재사용할 수 있습니다.

## 3. 주요 수식

1. **변형 맵**  

$$
     \varphi_a^{-1}(x) = x + f\bigl(\sin(Bx),\cos(Bx),\,a\bigr),
   $$
  
   – $$f$$는 MLP, $$a$$는 형상 파라미터, $$\sin,\cos$$ 특징 매핑 사용  

2. **기하학적 푸리에 변환**  
   - **전방 변환**:

 $$
       (\mathcal{F}\_a v)(k)
       = \int_{D_a} v(x)\,e^{-2\pi i\langle \varphi_a^{-1}(x),\,k\rangle}\,
         \bigl|\det\nabla\varphi_a^{-1}(x)\bigr|\,dx.
     $$

   - **역변환**:

$$
       (\mathcal{F}_a^{-1}\hat v)(x)
       = \sum_k \hat v(k)\,e^{2\pi i\langle \varphi_a^{-1}(x),\,k\rangle}.
     $$

이 둘을 균일 잠재 도메인에서 FFT/IFFT로 빠르게 구현합니다.

## 4. 성능 및 활용 사례

| 문제 유형             | 속도 이점            | 정확도 개선           |
|-------------------|-----------------|------------------|
| 공기역학 설계 (Euler) | 최대 $$10^5$$배 가속 | 기존 FNO 대비 오차 절반 |
| 탄성·소성 문제         | 0.01s 수준 추론      | 비균질 메쉬에서 우수    |
| 구면 대류 방정식       | 도메인 분할로 처리    | FNO/UNet보다 오류↓    |

- **실시간 설계 최적화**: 학습된 Geo-FNO를 이용해 공기역 형상 파라미터를 직접 미분 가능한 최적화에 활용 가능  
- **3D 확장**: 2D처럼 매니폴드 분할/연속화 기법을 도입하면 고차원에도 적용 가능  

## 5. 앞으로 연구 고려점

1. **복잡 토폴로지**: 다공성·고차원 몸체는 도메인 분할·연속화 기법 필요  
2. **이론적 보장**: Geo-FNO의 근사 성능 한계와 안정성 분석  
3. **Physics-Informed 확장**: PDE 물리 손실을 직접 학습에 포함하는 Geo-PINO 개발  

Geo-FNO는 **복잡 형상에서도 FFT 효율을 살리면서 정확도를 높이는** 혁신적 프레임워크로, 대학 수준에서도 프랙티컬한 PDE 대리 모델링과 설계 최적화에 활용할 수 있습니다.

[1] https://ppl-ai-file-upload.s3.amazonaws.com/web/direct-files/attachments/22370781/de6cb00a-5735-4727-aee7-87bff9b96643/2207.05209v2.pdf

## 1. 핵심 주장 및 주요 기여  
**Fourier Neural Operator with Learned Deformations (Geo-FNO)**는 임의의 형상을 갖는 도메인에 대해 효율적인 푸리에 스펙트럴 연산을 적용할 수 있도록, 물리적 공간을 균일한 잠재(latent) 계산 메쉬로 변형(mapping)하는 기하학적 변형 네트워크를 결합한 새로운 신경 연산자(neural operator) 프레임워크이다.  
- **핵심 주장**: 기존 Fourier Neural Operator(FNO)는 FFT에 제한되어 사각형 균일 그리드만 지원하지만, Geo-FNO는 도메인별 변형 함수를 학습하여 임의의 형상·비균질 메쉬에서도 FFT의 연산 효율을 유지하면서 정확도를 대폭 향상시킬 수 있다.  
- **주요 기여**:  
  1. 임의 형상·다양한 입력 형식(점군·메쉬·디자인 파라미터)을 지원하는 Geo-FNO 프레임워크 제안.  
  2. 물리 공간 Da와 균일 잠재 공간 Dc 간의 미분 동형 사상 $$\varphi_a$$ 혹은 $$\varphi_a^{-1}$$을 고정 또는 학습 가능 형태로 통합.  
  3. 다양한 PDE(탄성·소성·오일러·나비에–스토크스) 및 전진/역설계 문제에서 수치 해석기 대비 최대 $$10^5$$배 속도, 기존 FNO 대비 2배 정확도 개선.  
  4. 저해상도 학습 후 고해상도 평가가 가능한 **분산해상도 수렴성**(discretization-convergence) 유지.  

## 2. 논문 상세 설명  

### 2.1 해결하려는 문제  
- 전통적 스펙트럴 메서드는 균일 사각 토러스 도메인에만 적용 가능 → 복잡 형상·부정형 메쉬에서 비효율·정확도 저하  
- 비균질 메쉬 간 보간(interpolation) → 비선형 PDE에서 큰 보간 오차 발생  
- 임의 형상·메쉬에 대해 FFT 기반 글로벌 컨볼루션을 **효율적으로** 적용하는 방법 부재  

### 2.2 제안 방법  
#### 2.2.1 변형(deformation) 정의  
- 물리 도메인 Da와 계산 도메인 Dc(유닛 토러스) 사이의 가역 사상  

$$
    \varphi_a: D_c \to D_a,\quad \varphi_a^{-1}: D_a \to D_c
  $$

- 샘플 점 $$x\in D_a$$, 계산점 $$\xi=\varphi_a^{-1}(x)\in D_c$$  

#### 2.2.2 기하학적 푸리에 변환(Geometric Fourier Transform)  
- **전방 변환**:  

$$
    (\mathcal F_a v)(k)
    \;=\;\int_{D_a} v(x)\,e^{-2\pi i\langle \varphi_a^{-1}(x),k\rangle}\,\bigl|\det\nabla\varphi_a^{-1}(x)\bigr|\,dx.
  $$

- **역변환**:  

$$
    (\mathcal F_a^{-1}\hat v)(x)
    =\sum_k \hat v(k)\,e^{2\pi i\langle \varphi_a^{-1}(x),k\rangle}.
  $$

- 균일 메쉬 $$T^c$$상에서 FFT 활용  

#### 2.2.3 학습 가능한 변형 네트워크  
- 미리 정의된 구조 메쉬인 경우 인덱스 정규화로 사상 확보  
- **학습 시** feed-forward MLP $$f(x,a)$$로  

$$
    \varphi_a^{-1}(x,a) = x + f\bigl(\sin(Bx),\cos(Bx),a\bigr),
  $$
  
여기서 $$B$$는 사인·코사인 주기함수 특징 매핑  

#### 2.2.4 Geo-FNO 아키텍처  
- 기본 FNO 블록(입력 리프팅 $$P$$, 주파수 영역 컨볼루션 $$K_l$$, 출력 프로젝션 $$Q$$)에  
  - 입력 전·후 변형 적용:  
   
$$
      G_\theta=
      Q\;\circ\bigl(W^L + K_L(\varphi_a)+b^L\bigr)\circ\cdots\circ
      \sigma\bigl(W^1 + K_1(\varphi_a)+b^1\bigr)\circ P.
    $$

### 2.3 성능 향상 및 한계  
| 실험 예제 | 전통 수치해석 대비 속도 | FNO 인터폴레이션 대비 오류 감소 |
|:---------:|:--------------------:|:-----------------------------:|
| 공기역학 설계 (Euler) | 최대 $$10^5$$배[1] | 2배[1] |
| 탄성·소성 문제 | 0.02 vs 0.05 상대오차[1] | – |

- **속도**: 시간적 적분 불필요 → GPU 상 0.01s 수준  
- **정확도**: 보간 오차 제거로 비선형·부정형 메쉬에서 우수  
- **분산해상도 수렴성**: 훈련 저해상도→평가 고해상도 가능(공기역학 예: $$56\times51\to221\times51$$ 테스트 오차 0.0147→0.0428 유지)  

- **한계**  
  - 복잡 토폴로지(다공성, 고차원 매니폴드) 시 도메인 분할 혹은 차원 확장 필요  
  - 학습 가능한 변형 해석적 보장 부재 → 수치적 불안정성 가능성  

## 3. 일반화 성능 개선 가능성  
- **학습된 변형 네트워크**가 입력 형상·메쉬 다양성에 적응 → 신규 형상·해상도에서도 높은 일반화  
- **분산해상도 수렴성**: 함수공간 매핑 접근으로 새로운 그리드에서도 동일 파라미터 재사용  
- **도메인 분할(Connect-sum)** 및 **푸리에 연속화(Fourier continuation)** 기법 확장: 더 복잡한 지형·토폴로지 적용  
- **피직스 인포메이션 결합(PINO)**: PDE 잔차 항 추가하여 관측 데이터 부족 시에도 물리적 일관성 보장  

## 4. 향후 연구에 미치는 영향 및 고려사항  
- Geo-FNO는 **임의 형상 설계 최적화**, **실시간 PDE 시뮬레이션**, **대규모 설계 공간 탐색**에 큰 혁신 제공  
- **향후 연구**  
  1. 복잡 토폴로지·다중 연결 영역에 대한 효율적 도메인 분할 및 통합  
  2. 변형 네트워크의 **이론적 근사 보장** 및 안정성 분석  
  3. 물리 법칙 기반 **Physics-Informed Geo-FNO (Geo-PINO)** 개발  
  4. 3D 고차원 매니폴드(예: 곡면·체적) 확장 연구  

Geo-FNO는 스펙트럴 효율성·지오메트릭 유연성을 결합한 혁신적 Neural Operator로, 다양한 실제 공학·과학 문제 해법에 기여할 전망이다.

[1] https://ppl-ai-file-upload.s3.amazonaws.com/web/direct-files/attachments/22370781/de6cb00a-5735-4727-aee7-87bff9b96643/2207.05209v2.pdf
