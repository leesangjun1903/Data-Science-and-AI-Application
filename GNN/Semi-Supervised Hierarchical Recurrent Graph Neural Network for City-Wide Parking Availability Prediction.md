# Semi-Supervised Hierarchical Recurrent Graph Neural Network for City-Wide Parking Availability Prediction

## 1. 핵심 주장과 주요 기여

**SHARE(Semi-supervised Hierarchical Recurrent Graph Neural Network)** 모델은 도시 전체 주차 가용성 예측을 위한 혁신적인 프레임워크입니다. 이 논문의 핵심 주장은 **환경적 맥락 데이터와 부분적으로 관찰된 실시간 주차 데이터를 동시에 활용**하여 도시 규모의 주차 가용성을 정확하게 예측할 수 있다는 것입니다.[1]

**주요 기여는 네 가지로 요약됩니다:**

- **반지도 학습 기반 시공간 학습 프레임워크** 제안으로 환경 맥락 요인과 희소한 실시간 주차 데이터를 통합[1]
- **계층적 그래프 컨볼루션 모듈** 개발을 통해 주차장 간 **로컬 및 글로벌 공간 종속성** 동시 포착[1]
- **주차 가용성 근사 모듈** 제안으로 센서가 없는 주차장의 실시간 데이터를 **공간-시간 도메인에서 추정**[1]
- **베이징과 심천 데이터셋**에서 7개 최신 기준 모델 대비 **최고 성능** 달성[1]

## 2. 해결 문제와 제안 방법

### 해결하고자 하는 문제

논문은 도시 전체 주차 가용성 예측에서 **세 가지 핵심 도전 과제**를 다룹니다:[1]

1. **비유클리드 공간 자기상관**: 주차장 간의 불규칙하고 복잡한 공간적 상관관계 모델링
2. **동적 시간 자기상관**: 주차장 내부 및 주차장 간의 시변 시간 종속성 포착
3. **실시간 주차 데이터 부족**: 전체 주차장 중 극소수(베이징의 경우 6.12%)만 실시간 센서 보유[1]

### 제안 방법 및 수식

**SHARE 모델**은 세 가지 핵심 구성 요소로 이루어져 있습니다:[1]

#### 계층적 공간 종속성 모델링

**1) Contextual Graph Convolution (CxtConv)**
주변 주차장 간 로컬 공간 종속성을 포착합니다:

$$x'\_{c_i} = \sigma\left(\sum_{j \in N_i} \alpha_{ij}W_c x_{c_j}\right)$$[1]

여기서 근접성 점수는 어텐션 메커니즘으로 계산됩니다:

$$\alpha_{ij} = \frac{\exp(c_{ij})}{\sum_{k \in N_i} \exp(c_{ik})}$$[1]

**2) Soft Clustering Graph Convolution (SCConv)**
원거리 주차장 간 글로벌 상관관계를 포착하기 위해 **소프트 할당 매트릭스** S를 사용합니다:

$$S_{i,\cdot} = \text{Softmax}(W_s x_i)$$[1]

잠재 노드 표현은 다음과 같이 계산됩니다:

$$x^s_i = \sum_{j=1}^N S^T_{i,j} x_j$$[1]

#### 시간 종속성 모델링

**GRU(Gated Recurrent Unit)**를 활용하여 시간적 종속성을 모델링합니다:

$$h^t_i = (1-z^t_i) \circ h^{t-1}_i + z^t_i \circ \tilde{h}^t_i$$[1]

여기서:

$$r^t_i = \sigma(W_r[h^{t-1}_i \oplus x^t_i] + b_r)$$

$$z^t_i = \sigma(W_z[h^{t-1}_i \oplus x^t_i] + b_z)$$

```math
\tilde{h}^t_i = \tanh(W_{\tilde{h}}[r^t_i \circ h^{t-1}_i \oplus x^t_i] + b_{\tilde{h}})
```
 [1]

#### 주차 가용성 근사 모듈

센서가 없는 주차장의 데이터를 **공간적-시간적 도메인**에서 추정합니다:

**공간 기반 근사**:

$$x^{sp}\_i = \sum_{j \in N_i} \alpha_{ij} y_j$$[1]

**시간 기반 근사**:

```math
x^{tp,t}_i = \text{Softmax}(W_{tp} h^{t-1}_i)
```

[1]

**엔트로피 기반 융합**:

```math
x^p_i = \frac{\exp(-H(x^{sp}_i))x^{sp}_i + \exp(-H(x^{tp}_i))x^{tp}_i}{Z_i}
```

### 모델 구조

SHARE의 전체 아키텍처는 **입력으로 맥락 특성과 부분적으로 관찰된 실시간 주차 데이터**를 받아, **다음 τ 시간 단계의 모든 주차장 예측값**을 출력합니다. 세 가지 주요 모듈이 순차적으로 연결되어 **공간-시간 종속성을 계층적으로 포착**합니다.[1]

## 3. 성능 향상 및 한계

### 성능 향상

**SHARE 모델**은 베이징과 심천 데이터셋에서 **획기적인 성능 개선**을 달성했습니다:[1]

**베이징 데이터셋 (15분/30분/45분 예측)**:
- 최신 기법(DCRNN) 대비 MAE: **31.8%/31.3%/29.9%** 개선
- 최신 기법(DCRNN) 대비 RMSE: **30.9%/31.5%/30.9%** 개선[1]

**심천 데이터셋**:
- MAE: **29.6%/28.7%/30.5%** 개선
- RMSE: **28.8%/28.8%/28.4%** 개선[1]

**절제 실험 결과**에서도 각 모듈의 효과성이 입증되었습니다:
- PA 근사 모듈 추가로 **18.6% MAE 감소**
- SCConv 블록 추가로 **14.2% 추가 MAE 감소**[1]

### 모델의 한계

논문에서 확인된 주요 한계점들:

1. **대형 주차장에서의 성능 저하**: 주차 공간이 많은 지역(평균 601개 vs 전체 평균 210개)에서 MAE가 **31.6으로 전체 평균 10.68보다 현저히 높음**[1]

2. **센서 비율 의존성**: 라벨링된 주차장 비율이 높을수록 성능이 향상되지만, **경제적 비용과 정책적 제약** 존재[1]

3. **시간 윈도우 민감성**: 입력 길이 T=12에서 최적 성능을 보이며, **너무 짧거나 긴 입력 시 성능 저하**[1]

4. **예측 범위 제약**: τ가 증가할수록 **모든 주차장에서 일관된 오류 증가**[1]

## 4. 일반화 성능 향상 가능성

### 모델의 일반화 강화 요소

**1) 계층적 공간 모델링**
- **로컬-글로벌 공간 종속성 동시 포착**으로 다양한 도시 구조에 적응 가능[1]
- **소프트 클러스터링**을 통해 각 주차장이 **여러 기능적 클러스터에 유연하게 소속** 가능[1]

**2) 반지도 학습 패러다임**
- **부분적 라벨 데이터로도 전체 도시 규모 예측** 가능하여 데이터 부족 상황에서도 효과적[1]
- **MSE와 Cross Entropy 손실의 결합**으로 라벨된 데이터와 근사 데이터 모두 활용[1]

**3) 도시 간 성능 일관성**
- **베이징과 심천이라는 서로 다른 특성의 도시**에서 일관된 우수 성능 달성[1]
- 심천에서 상대적으로 낮은 오류율은 **밀도가 높고 균등하게 분포된 주차장 구조에서 더 용이한 예측** 가능성을 시사[1]

### 일반화 성능 개선 방향

**1) 적응적 파라미터 조정**
- **잠재 노드 비율 K/N = 0.1**에서 최적 성능을 보여, 도시별 특성에 맞는 **적응적 클러스터링** 전략 필요[1]

**2) 다양한 도시 형태에 대한 확장성**
- **밀집도와 분포 패턴이 다른 도시**에서의 성능 검증을 통한 모델 견고성 향상 필요

**3) 센서 배치 최적화**
- **비용 효율적인 센서 비율과 최적 센서 분포** 탐색을 통한 실용적 배치 전략 개발[1]

## 5. 연구 영향과 향후 고려사항

### 앞으로의 연구에 미치는 영향

**1) 스마트 시티 연구 분야**
- **PGI(Parking Guidance and Information) 시스템**의 실용적 구현을 위한 기술적 기반 제공[1]
- **도시 교통 체증 완화**(순환 차량이 전체 교통 체증의 40% 기여)에 대한 구체적 솔루션[1]

**2) 그래프 신경망 연구**
- **계층적 그래프 컨볼루션 아키텍처**가 기존 GNN의 한계(깊은 레이어에서의 구별력 손실) 극복[1]
- **소프트 클러스터링 기법**이 노드 수준 예측을 위한 글로벌 공간 상관관계 포착에 새로운 접근법 제시[1]

**3) 시공간 예측 연구**
- **반지도 학습과 시공간 모델링의 결합**이 교통 흐름 예측, 택시 수요 예측 등 관련 분야에 확장 가능[1]

### 앞으로 연구 시 고려할 점

**1) 실용적 배치 관점**
- **센서 설치 비용과 성능 간의 트레이드오프** 분석을 통한 경제적 타당성 확보[1]
- **프라이버시 정책과 데이터 수집 제약** 고려한 현실적 구현 방안 모색[1]

**2) 모델 확장성**
- **대형 주차장에서의 성능 최적화**를 위한 추가적인 모델 개선 필요[1]
- **다양한 도시 규모와 구조**에 대한 일반화 성능 검증 및 개선

**3) 기술적 발전 방향**
- **실시간 처리 능력과 계산 효율성** 개선을 통한 실제 서비스 배치 준비
- **외부 요인**(날씨, 이벤트, 교통 상황 등)을 추가적으로 고려한 더욱 정교한 예측 모델 개발

**4) 데이터 품질과 신뢰성**
- **간접적 신호**(사용자 피드백 등)의 **편향성과 지연성** 문제 해결 방안 연구[1]
- **다중 데이터 소스 융합** 기법을 통한 예측 신뢰성 향상

이 연구는 **도시 교통 문제 해결을 위한 AI 기반 솔루션**의 실용적 가능성을 제시하며, **그래프 신경망과 반지도 학습의 새로운 응용 영역**을 개척한 중요한 기여로 평가됩니다.[1]

[1](https://ppl-ai-file-upload.s3.amazonaws.com/web/direct-files/attachments/65988149/94351aa8-2e98-4617-81c1-5a1ab1af89af/1911.10516v1.pdf)
