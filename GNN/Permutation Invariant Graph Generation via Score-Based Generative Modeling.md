# Permutation Invariant Graph Generation via Score-Based Generative Modeling | 2020 · 347회 인용

## **1. 핵심 주장과 주요 기여**

이 논문은 **그래프 생성 모델에서 순열 불변성(permutation invariance)을 완전히 보장하는 새로운 접근법**을 제시합니다. 기존 그래프 생성 모델들(GraphVAE, GraphRNN 등)이 노드 순서에 따른 편향을 가지는 문제를 해결하기 위해, **score-based generative modeling과 순열 등변성(permutation equivariant) 그래프 신경망을 결합**한 혁신적인 방법론을 제안합니다.[1]

**주요 기여**는 다음과 같습니다:
- **EDP-GNN(Edgewise Dense Prediction Graph Neural Network)** 아키텍처 개발로 멀티채널 학습 가능한 인접 행렬을 활용한 edge-wise 예측 능력 향상[1]
- Score-based generative modeling을 그래프 도메인으로 확장하여 **이론적으로 완전한 순열 불변성** 보장[1]
- 그래프 알고리즘 학습(최단 경로, 최대 신장 트리)에서 기존 GNN 대비 **현저한 성능 향상** 달성[1]

## **2. 해결하고자 하는 문제와 제안 방법**

### **해결하고자 하는 문제**
그래프는 $$N$$개의 노드를 가질 때 $$N!$$개의 서로 다른 인접 행렬로 표현될 수 있지만 모두 동일한 그래프를 나타냅니다. 기존 생성 모델들은 이러한 **순열 불변성을 완전히 보장하지 못해 학습된 분포에 원치 않는 편향**이 발생합니다.[1]

### **제안하는 방법**

**Score-based Generative Modeling 적용**: 확률 밀도 함수 $$p(x)$$ 대신 score 함수 $$\nabla_x \log p(x)$$를 직접 학습합니다. 훈련 손실 함수는 다음과 같습니다:[1]

$$\mathcal{L}_{\{\sigma_i\}_{i=1}^L} = \frac{1}{2L} \sum_{i=1}^L \frac{\lambda_i}{\sigma_i^2} \mathbb{E}_{A \sim p_{\text{data}}(A), \tilde{A} \sim q_{\sigma_i}(\tilde{A}|A)} \left[\|s_\theta(\tilde{A}, \sigma_i) - \nabla_{\tilde{A}} \log q_{\sigma_i}(\tilde{A}|A)\|_2^2\right]$$ 

여기서 $$q_{\sigma_i}(\tilde{A}|A)$$는 가우시안 노이즈 분포이고, $$s_\theta$$는 학습할 score 네트워크입니다[1].

**순열 불변성 보장**: Theorem 1에 의해 순열 등변성 score 함수 $$s$$가 있다면, 이로부터 유도되는 스칼라 함수는 순열 불변성을 가집니다:[1]

$$\log p(A) = \int_{[0, A]} \langle s(X), dX \rangle_F + \log p(0)$$

**Annealed Langevin Dynamics 샘플링**: 여러 노이즈 레벨에서 순차적으로 샘플링하여 최종 그래프를 생성합니다:[1]

$$x_t = x_{t-1} + \frac{\epsilon_i}{2} s_\theta(x_{t-1}, \sigma_i) + \sqrt{\epsilon_i} z_t$$

## **3. 모델 구조 - EDP-GNN**

**Multi-Channel GNN Layer**: GIN을 확장하여 여러 채널에서 동시에 메시지 패싱을 수행합니다:[1]

```math
Z^{(m+1)}_{(c,i)} = \text{MLP}_m^{\text{Node}}\left(\text{CONCAT}\left(\left\{Z^{(m+1)}_{(c,i)} = (1+\epsilon) \cdot Z^m_i + \sum_{j \in \mathcal{N}_i} Z^m_j\right\}_{c=0,...,C-1}\right)\right)
```

**EDP-GNN Layer**: 두 단계로 구성됩니다:[1]
1. **노드 특성 추론**: MultiChannelGNN으로 그래프의 지역 구조를 노드 특성으로 인코딩
2. **엣지 특성 추론**: 각 엣지의 특성 벡터를 업데이트

$$A^{(k+1)}_{c,i,j} = \text{MLP}_k^{\text{Edge}}\left(\text{CONCAT}(A^{(k)}_{c,i,j}, Z^{(k+1)}_i, Z^{(k+1)}_j)\right)$$

대칭성 보장을 위해: $$A^{(k+1)} = \frac{A^{(k+1)} + (A^{(k+1)})^T}{2}$$[1]

## **4. 성능 향상과 한계**

### **성능 향상**
- **그래프 알고리즘 학습**: 가중 그래프에서 최단 경로 예측 정확도 0.92 (GIN: 0.12), 최대 신장 트리 예측 정확도 0.84 (GIN: 0.20) 달성[1]
- **그래프 생성**: Community-small과 Ego-small 데이터셋에서 MMD 평균 0.031로 기존 방법들 대비 **최고 성능** 기록[1]
- **Ablation Study**: 학습 가능한 멀티채널 특성이 모두 필요함을 실증적으로 입증[1]

### **한계점**
- **계산 복잡도**: 모델의 확장성 개선이 필요하며, 그래프 풀링 기법 등을 통한 최적화가 향후 연구 과제[1]
- **소규모 데이터셋**: 실험이 상대적으로 작은 규모의 그래프(4-30 노드)에서만 수행됨[1]
- **연속-이산 변환**: 연속 공간에서 생성된 결과를 이산 그래프로 변환하는 과정에서 정보 손실 가능성[1]

## **5. 일반화 성능 향상 가능성**

이 모델의 **일반화 성능 향상**은 다음 측면에서 기대됩니다:

**순열 불변성으로 인한 편향 제거**: 기존 모델들이 특정 노드 순서에 과적합되는 문제를 근본적으로 해결하여, **다양한 그래프 구조에 대한 일반화 능력**이 크게 향상됩니다.[1]

**멀티채널 학습**: EDP-GNN의 중간 채널들이 **그래프의 다양한 구조적 특성을 계층적으로 학습**하여, 노이즈가 있는 입력에서도 명확한 구조를 복원하는 능력을 보입니다. 이는 실제 데이터의 노이즈나 불완전성에 대한 **강건성(robustness) 향상**으로 이어집니다.[1]

**Edge-wise 예측 능력**: 전통적인 node-centric GNN과 달리 **edge 중심의 예측**이 가능하여, 그래프의 국소적 연결 패턴을 더 정확하게 모델링할 수 있습니다.[1]

## **6. 앞으로의 연구 영향과 고려사항**

### **연구에 미치는 영향**

**그래프 생성 모델 패러다임 전환**: 순열 불변성을 이론적으로 보장하는 최초의 완전한 해법을 제시하여, 향후 그래프 생성 연구의 **새로운 표준**이 될 가능성이 높습니다.[1]

**Score-based 모델의 확장**: 이미지나 텍스트 도메인에서 성공한 score-based generative modeling을 그래프 도메인으로 성공적으로 확장하여, **다양한 구조화된 데이터**로의 적용 가능성을 열었습니다.[1]

**멀티모달 그래프 학습**: EDP-GNN의 멀티채널 접근법은 **다양한 유형의 그래프 정보**(속성, 관계 유형 등)를 동시에 처리할 수 있는 기반을 제공합니다.[1]

### **앞으로의 연구 고려사항**

**확장성 개선**: 대규모 그래프(수천-수만 노드)에 적용하기 위한 **계산 효율성 최적화**가 필요합니다. 그래프 풀링, 계층적 샘플링 등의 기법 개발이 요구됩니다.[1]

**동적 그래프 모델링**: 시간에 따라 변화하는 그래프 구조를 모델링하기 위한 **temporal score-based 모델** 개발이 향후 중요한 연구 방향입니다.

**도메인 특화 적용**: 분자 설계, 소셜 네트워크 분석, 지식 그래프 등 **특정 도메인의 제약조건과 특성**을 반영한 모델 변형이 필요합니다.

**해석가능성 향상**: EDP-GNN의 중간 채널들이 학습하는 **그래프 구조적 의미에 대한 이해**를 더욱 심화하여 모델의 투명성을 높여야 합니다.[1]

이 논문은 그래프 생성 모델링 분야에서 **이론적 완전성과 실용적 효과**를 모두 달성한 중요한 기여로, 향후 많은 후속 연구의 기반이 될 것으로 예상됩니다.

[1](https://ppl-ai-file-upload.s3.amazonaws.com/web/direct-files/attachments/65988149/44b87a85-49c8-4683-a32e-d05985b5878a/2003.00638v1.pdf)
