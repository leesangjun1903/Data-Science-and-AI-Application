# On sequential Monte Carlo sampling methods for Bayesian filtering
# 핵심 요약

**주요 주장**  
이 논문은 비선형·비가우시안 상태 공간 모델에 대한 베이지안 필터링 문제를 다루며, 전통적인 칼만 필터의 한계를 극복하기 위해 **Sequential Monte Carlo (SMC) 샘플링** 기법(일명 입자 필터)을 통합적 프레임워크로 제시한다. SMC 방법은 중요도 샘플링과 재샘플링을 결합하여, 시간축상으로 순차적으로 후방분포를 근사하면서 효율적으로 상태 추정을 수행할 수 있음을 보인다.[1]

**주요 기여**  
- 일반화된 SIS(Sequential Importance Sampling) 필터 제시: 중요도 함수 선택과 가중치 업데이트를 수식화하여 단일 알고리즘으로 통합.[1]
- 최적·준최적 중요도 함수 이론적 도출: 후방분포를 최소 분산 방식으로 근사하는 중요도 함수를 제시하고, 실제로 사용할 수 있는 선형화·가우시안 근사 기법 제안.[1]
- Rao–Blackwellisation 적용: 조건부 선형·가우시안 구조를 분석적으로 처리함으로써 분산을 크게 줄이는 하이브리드 필터 개발.[1]
- 예측·스무딩·우도 평가 알고리즘 확장: 고정 지연(fixed-lag) 및 전체 구간 스무딩, 데이터 우도 추정 방법 제시.[1]

***

# 문제 설정 및 제안 기법

비선형·비가우시안 상태 공간 모델  

$$
\begin{aligned}
x_k &\sim p(x_k \mid x_{k-1}),\\
y_k &\sim p(y_k \mid x_k),
\end{aligned}
$$  

여기서 후방분포 $$p(x_{0:k}\mid y_{0:k})$$를 시간 순서대로 갱신하는 것이 목적이다.[1]

## SIS 필터와 중요도 함수

제안된 **Sequential Importance Sampling (SIS)** 알고리즘  
1. 샘플링  
   $$\displaystyle x_k^{(i)} \sim \pi(x_k\mid x_{0:k-1}^{(i)},y_{0:k})$$  
2. 가중치 갱신  

```math
   w_k^{*(i)} = w_{k-1}^{*(i)}
   \frac{p(y_k\mid x_k^{(i)})\,p(x_k^{(i)}\mid x_{k-1}^{(i)})}
        {\pi(x_k^{(i)}\mid x_{0:k-1}^{(i)},y_{0:k})}
```

3. 정규화  
   
$$\tilde w_k^{(i)} = w\_k^{\*(i)}/\sum_j w_k^{*(j)}$$  

### 최적 중요도 함수  

```math
\pi^*(x_k\mid x_{k-1},y_k)
= p(x_k\mid x_{k-1},y_k),
\quad
w_k^{*(i)} = w_{k-1}^{*(i)}\,p(y_k\mid x_{k-1}^{(i)})
``` 

그러나 일반 모델에서 샘플링·밀도평가 불가능.[1]

### 준최적 중요도 함수: 국소 선형화  
관측 방정식을 1차 테일러 전개하여  

$$
y_k \approx g(f(x_{k-1})) + G_k\,(x_k - f(x_{k-1})) + w_k
$$  

$$
G_k = \left.\frac{\partial g}{\partial x}\right|\_{x=f(x_{k-1})}
$$  

이로부터  

$$
\pi(x_k\mid x_{k-1},y_k)
= \mathcal{N}\bigl(m_k,\,\Sigma_k\bigr)
$$  

$$
\Sigma_k^{-1}
= Q^{-1} + G_k^\top R^{-1}G_k,\quad
m_k
=\Sigma_k\bigl(Q^{-1}f(x_{k-1}) + G_k^\top R^{-1}(y_k - g(f(x_{k-1})) + G_kf(x_{k-1}))\bigr)
$$  

($$Q,R$$: 프로세스·관측 잡음 공분산).[1]

## 재샘플링 및 Rao–Blackwellisation

- **SIR(residual/stratified) 재샘플링**: 유효 표본 크기  
  
$$\hat N_{\rm eff}=1/\sum_i(\tilde w_k^{(i)})^2$$  
  
임계치 이하 시 재샘플링 수행.[1]

- **Rao–Blackwellisation**: 상태를 $$(x^1_k,x^2_k)$$로 분할하고, $$x^2_k$$가 선형·가우시안인 경우 칼만 필터로 아날리틱 처리 후 Monte Carlo 분산 감소.[1]

***

# 성능 향상 및 한계

**성능 향상**  
- 최적 중요도 함수 사용 시 샘플 소모 최소화 및 재샘플링 횟수 현격히 감소.  
- 국소 선형화 기법으로 실제 모델에 적용 가능하면서도 재샘플링 빈도 절반 이하로 감축.[1]
- Rao–Blackwellisation으로 분석적 분산 감소→샘플 수 크게 줄여도 정확도 유지.

**한계**  
- 중요도 함수 선택과 재샘플링 빈도에 의존: 잘못된 선택 시 입자 소멸(degeneration) 심화.  
- 고차원 상태 공간에서는 샘플 수 $$N$$이 기하급수적으로 증가해야 하는 ‘차원의 저주’ 문제 지속.  
- 고정 하이퍼파라미터(예: 잡음 공분산) 추정은 미포함→실제 모델링 상황에선 마르코프 연쇄 몬테카를로(MCMC) 결합 필요.[1]

***

# 일반화 성능 향상 전망

- **적응적 중요도 함수** 연구: 매 시점 관측 정보에 맞춰 중요도 함수를 온라인으로 조정하면 과적합 방지 및 일반화 능력 향상 가능.  
- **하이퍼파라미터 학습 연계**: Rao–Blackwellisation과 MCMC를 결합해 잡음 분산 등 비동적 파라미터를 샘플링하면 모델 불확실성 반영 및 신규 데이터에 대한 적응력 제고.  
- **고차원 모델 확장**: 스파스 구조나 저차원 잠재변수 분해 기법 활용 시 입자 수 요구량을 완화하여 딥 러닝 기반 동적 시스템에 적용 가능성 모색.

***

# 향후 연구 영향 및 고려 사항

본 논문은 **SMC 방법론의 이론적 통합**을 통해 베이지안 필터링의 표준적 틀을 제시했으며, 이후 **입자 필터의 산업·학계 활용**에 결정적 기반을 제공했다. 향후 연구에서는  
- **온라인 적응 메커니즘**: 중요도 함수·재샘플링 기준을 데이터 특성에 맞춰 자동 조정  
- **MCMC와의 하이브리드**: 고정 파라미터 추정 및 다중 모드 후방분포 탐색 성능 강화  
- **분산 컴퓨팅 프레임워크**: 대규모 입자 병렬화 아키텍처 개발  
등을 고려하여 SMC 기법의 **일반화 성능**과 **실시간 적용성**을 더욱 높이는 방향으로 발전할 것이다.

[1] https://ppl-ai-file-upload.s3.amazonaws.com/web/direct-files/attachments/22370781/a2510fa0-c1a1-4180-a525-5345c2e3083b/doucet_godsill_andrieu_sequentialmontecarloforbayesfiltering.pdf
